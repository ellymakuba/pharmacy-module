<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
	http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

    <!-- See http://wiki.openmrs.org/display/docs/Module+liquibase+File for
         documentation on this file. See http://www.liquibase.org/manual/home#available_database_refactorings
         for a list of supported elements and attributes -->


    <changeSet
            id="pharmacy-2012-12-12-8:00"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_supplier"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_supplier table


        </comment>

        <createTable tableName="pharmacy_supplier">

            <column
                    name="pharmacy_supplier_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="char(38)"/>

            <column
                    name="description"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_supplier">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_supplier_id"
                tableName="pharmacy_supplier"/>

        <update tableName="pharmacy_supplier">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>


    <!--///////////////////////////////////////////////////////////////////////////////////-->
    <changeSet
            id="pharmacy-2012-12-12-8:01"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_locations"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_locations table


        </comment>

        <createTable tableName="pharmacy_locations">

            <column
                    name="pharmacy_locations_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="char(38)"/>

            <column
                    name="description"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_locations">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_locations_id"
                tableName="pharmacy_locations"/>

        <update tableName="pharmacy_locations">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:02"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_transaction_type"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_transaction_type table


        </comment>

        <createTable tableName="pharmacy_transaction_type">

            <column
                    name="pharmacy_transaction_type_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="char(38)"/>

            <column
                    name="description"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_transaction_type">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_transaction_type_id"
                tableName="pharmacy_transaction_type"/>

        <update tableName="pharmacy_transaction_type">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:03"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_category"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_category table


        </comment>

        <createTable tableName="pharmacy_category">

            <column
                    name="pharmacy_category_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="char(38)"/>

            <column
                    name="description"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_category">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_category_id"
                tableName="pharmacy_category"/>

        <update tableName="pharmacy_category">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>


    <changeSet
            id="pharmacy-2012-12-12-8:04"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_inventory_incoming"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_inventory_incoming table


        </comment>

        <createTable tableName="pharmacy_inventory_incoming">

            <column
                    name="pharmacy_inventory_incoming_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="pharmacy_drug_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="quantity_in"
                    type="int(11)"/>

            <column
                    name="maxlevel"
                    type="int(11)"/>

            <column
                    name="minlevel"
                    type="int(11)"/>

            <column
                    name="batch_no"
                    type="int(11)">
            </column>

            <column
                    name="s11_no"
                    type="int(11)">
            </column>

            <column
                    name="expiredate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="delivery_no"
                    type="int(11)">
            </column>

            <column
                    name="change_reason"
                    type="text"/>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="destination_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="supplier_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="transaction_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="approved"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="requestedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="issuedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="authorizedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="status"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_inventory_incoming">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_inventory_incoming_id"
                tableName="pharmacy_inventory_incoming"/>

        <addForeignKeyConstraint
                baseColumnNames="destination_uuid"
                baseTableName="pharmacy_inventory_incoming"
                constraintName="pharmacy_inventory_incoming_destination__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_inventory_incoming"
                constraintName="pharmacy_inventory_incoming_location__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="supplier_uuid"
                baseTableName="pharmacy_inventory_incoming"
                constraintName="pharmacy_inventory_incoming_supplier__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_supplier"/>

        <addForeignKeyConstraint
                baseColumnNames="transaction_uuid"
                baseTableName="pharmacy_inventory_incoming"
                constraintName="pharmacy_inventory_incoming_transaction__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_transaction_type"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_inventory_incoming"
                constraintName="pharmacy_inventory_incoming_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <update tableName="pharmacy_inventory_incoming">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:05"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_inventory_outgoing"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_inventory_outgoing table


        </comment>

        <createTable tableName="pharmacy_inventory_outgoing">

            <column
                    name="pharmacy_inventory_outgoing_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="quantity_in"
                    type="int(11)"/>

            <column
                    name="maxlevel"
                    type="int(11)"/>

            <column
                    name="minlevel"
                    type="int(11)"/>

            <column
                    name="batch_no"
                    type="int(11)">
            </column>

            <column
                    name="s11_no"
                    type="int(11)">
            </column>

            <column
                    name="expiredate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_drug_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="destination_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="supplier_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="transaction_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="incoming_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="delivery_no"
                    type="int(11)">
            </column>

            <column
                    name="change_reason"
                    type="text"/>

            <column
                    name="approved"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="requestedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="issuedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="authorizedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="status"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_inventory_outgoing">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_inventory_outgoing_id"
                tableName="pharmacy_inventory_outgoing"/>

        <addForeignKeyConstraint
                baseColumnNames="destination_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_destination__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_location__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="supplier_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_supplier__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_supplier"/>

        <addForeignKeyConstraint
                baseColumnNames="transaction_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_transaction__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_transaction_type"/>

        <addForeignKeyConstraint
                baseColumnNames="incoming_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_incoming__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory_incoming"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_drug_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_drug__fk"
                referencedColumnNames="uuid"
                referencedTableName="drug"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_inventory_outgoing"
                constraintName="pharmacy_inventory_outgoing_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <update tableName="pharmacy_inventory_outgoing">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:06"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_inventory"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_inventory table


        </comment>


        <createTable tableName="pharmacy_inventory">

            <column
                    name="pharmacy_inventory_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="pharmacy_drug_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="quantity"
                    type="int(11)"/>

            <column
                    name="quantity_in"
                    type="int(11)"/>

            <column
                    name="quantity_out"
                    type="int(11)"/>

            <column
                    name="maxlevel"
                    type="int(11)"/>

            <column
                    name="minlevel"
                    type="int(11)"/>

            <column
                    name="change_reason"
                    type="text"/>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="batch_no"
                    type="int(11)">
            </column>

            <column
                    name="s11_no"
                    type="int(11)">
            </column>

            <column
                    name="supplier_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="transaction_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="delivery_no"
                    type="int(11)">
            </column>

            <column
                    name="expiredate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="stock_reason"
                    type="text">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_inventory_outgoing_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_inventory_incoming_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_inventory">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_inventory_id"
                tableName="pharmacy_inventory"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_inventory_outgoing_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_outgoing__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory_outgoing"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_inventory_incoming_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_incoming_two__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory_incoming"/>

        <addForeignKeyConstraint
                baseColumnNames="supplier_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_supplier__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_supplier"/>

        <addForeignKeyConstraint
                baseColumnNames="transaction_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_transaction__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_transaction_type"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_drug_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_drug_fk"
                referencedColumnNames="uuid"
                referencedTableName="drug"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_inventory"
                constraintName="pharmacy_inventory_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <update tableName="pharmacy_inventory">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:07"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_drug_transactions"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_drug_transactions table


        </comment>

        <createTable tableName="pharmacy_drug_transactions">

            <column
                    name="pharmacy_drug_transactions_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="pharmacy_drug_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="quantity_in"
                    type="int(11)"/>

            <column
                    name="quantity_out"
                    type="int(11)"/>

            <column
                    name="comment"
                    type="varchar(255)"/>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="expiredate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_drug_transactions">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_drug_transactions_id"
                tableName="pharmacy_drug_transactions"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_drug_uuid"
                baseTableName="pharmacy_drug_transactions"
                constraintName="pharmacy_drug_transactions_drug_fk"
                referencedColumnNames="uuid"
                referencedTableName="drug"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_drug_transactions"
                constraintName="pharmacy_drug_transactions_location__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_drug_transactions"
                constraintName="pharmacy_drug_transactions_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <update tableName="pharmacy_drug_transactions">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:88"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_encounter_type"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_encounter_type table


        </comment>

        <createTable tableName="pharmacy_encounter_type">

            <column
                    name="pharmacy_encounter_type_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="varchar(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="description"
                    type="varchar(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_encounter_type">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_encounter_type_id"
                tableName="pharmacy_encounter_type"/>

        <update tableName="pharmacy_encounter_type">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:99"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_encounter"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_encounter table


        </comment>

        <createTable tableName="pharmacy_encounter">

            <column
                    name="pharmacy_encounter_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="pharmacy_encounter_type_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="patient_uuid"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="form_name"
                    type="varchar(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="encounter_datetime"
                    type="datetime">

                <constraints nullable="false"/>
            </column>

            <column
                    name="nextvisitDate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>
            <column
                    name="duration"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_encounter">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_encounter_id"
                tableName="pharmacy_encounter"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_encounter"
                constraintName="pharmacy_encounter_location_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_encounter_type_uuid"
                baseTableName="pharmacy_encounter"
                constraintName="pharmacy_encounter_pharmacy_encounter_type_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_encounter_type"/>

        <addForeignKeyConstraint
                baseColumnNames="patient_uuid"
                baseTableName="pharmacy_encounter"
                constraintName="pharmacy_encounter_patientt_fk"
                referencedColumnNames="patient_id"
                referencedTableName="patient"/>

        <update tableName="pharmacy_encounter">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:10"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_general_variables"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_general_variables table


        </comment>

        <createTable tableName="pharmacy_general_variables">

            <column
                    name="pharmacy_general_variables_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="name"
                    type="text"/>

            <column
                    name="description"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_general_variables">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_general_variables_id"
                tableName="pharmacy_general_variables"/>

        <update tableName="pharmacy_general_variables">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>
    <changeSet
            id="pharmacy-2012-12-12-8:26"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_drug_extra"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_drug_extra table


        </comment>

        <createTable tableName="pharmacy_drug_extra">

            <column
                    name="pharmacy_drug_extra_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>



            <column
                    name="variable"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>



            <column
                    name="receipt"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="invoice"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="waiverNo"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="amount"
                    type="double">

                <constraints nullable="true"/>
            </column>
            <column
                    name="wAmount"
                    type="double">

                <constraints nullable="true"/>
            </column>



            <column
                    name="pill"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="drug_change"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="chosen_value"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="doseCalculation"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_drug_extra">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_drug_extra_id"
                tableName="pharmacy_drug_extra"/>




        <addForeignKeyConstraint
                baseColumnNames="variable"
                baseTableName="pharmacy_drug_extra"
                constraintName="pharmacy_v_uuid__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_general_variables"/>

        <update tableName="pharmacy_drug_extra">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:22"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_orders"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_orders table


        </comment>

        <createTable tableName="pharmacy_orders">

            <column
                    name="pharmacy_order_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="concept_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="encounter_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="instructions"
                    type="varchar(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="startdate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="auto_end_date"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="discontinued"
                    type="smallint(6)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="discontinued_date"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="discontinued_reason"
                    type="varchar(1000)">

                <constraints nullable="true"/>
            </column>


            <column
                    name="dispensed"
                    type="smallint(6)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column


                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>


            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_orders">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_order_id"
                tableName="pharmacy_orders"/>

        <addForeignKeyConstraint
                baseColumnNames="encounter_uuid"
                baseTableName="pharmacy_orders"
                constraintName="pharmacy_order_encounter__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_encounter"/>



        <update tableName="pharmacy_orders">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>



    <changeSet
            id="pharmacy-2012-12-12-8:233"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_drug_order"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_drug_order table


        </comment>

        <createTable tableName="pharmacy_drug_order">


            <column name="pharmacy_drug_order_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="order_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="drug_inventory_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
            <column
                    name="drug_extra_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>


            <column
                    name="dose"
                    type="double">

                <constraints nullable="true"/>
            </column>
            <column
                    name="equivalent_daily_dose"
                    type="double">

                <constraints nullable="true"/>
            </column>


            <column
                    name="units"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="frequency"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="quantity_given"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="quantity_prescribed"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>


            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_drug_order">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_drug_order_id"
                tableName="pharmacy_drug_order"/>

        <addForeignKeyConstraint
                baseColumnNames="drug_inventory_uuid"
                baseTableName="pharmacy_drug_order"
                constraintName="pharmacy_drug_order_inventory_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory"/>
        <addForeignKeyConstraint
                baseColumnNames="order_uuid"
                baseTableName="pharmacy_drug_order"
                constraintName="pharmacy_drug_order_orders_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_orders"/>


        <addForeignKeyConstraint
                baseColumnNames="drug_extra_uuid"
                baseTableName="pharmacy_drug_order"
                constraintName="pharmacy_drug_order_extra_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_drug_extra"/>


        <update tableName="pharmacy_drug_order">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>


    <changeSet
            id="pharmacy-2012-12-12-8:24"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_obs"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_obs table


        </comment>

        <createTable tableName="pharmacy_obs">

            <column
                    name="pharmacy_obs_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="patient_uuid"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="concept_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="encounter_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="order_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="obs_datetime"
                    type="datetime">

                <constraints nullable="true"/>
            </column>
            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="obs_group_id"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_group_id"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>


            <column
                    name="value_boolen"
                    type="tinyint(4)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_coded"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_coded_name"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>
            <column
                    name="value_drug"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_datetime"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_numeric"
                    type="double">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_modifier"
                    type="varchar(2)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value_text"
                    type="text">

                <constraints nullable="true"/>
            </column>

            <column
                    name="datetime_started"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="datetime_stopped"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="comment"
                    type="text"/>

            <column
                    name="prescriberId"
                    type="char(38)">
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_obs">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_obs_id"
                tableName="pharmacy_obs"/>

        <addForeignKeyConstraint
                baseColumnNames="encounter_uuid"
                baseTableName="pharmacy_obs"
                constraintName="obs_encounter_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_encounter"/>
        <addForeignKeyConstraint
                baseColumnNames="order_uuid"
                baseTableName="pharmacy_obs"
                constraintName="obs_orders_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_orders"/>


        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_obs"
                constraintName="pharmacy_obs_location_fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>
        <addForeignKeyConstraint
                baseColumnNames="value_drug"
                baseTableName="pharmacy_obs"
                constraintName="pharmacy_value_drug_fk"
                referencedColumnNames="uuid"
                referencedTableName="drug"/>

        <addForeignKeyConstraint
                baseColumnNames="patient_uuid"
                baseTableName="pharmacy_obs"
                constraintName="pharmacy_obs_person_fk"
                referencedColumnNames="patient_id"
                referencedTableName="patient"/>

        <update tableName="pharmacy_obs">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>

    </changeSet>


    <changeSet
            id="pharmacy-2012-12-12-8:25"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_drug_dispense_settings"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_drug_dispense_settings table


        </comment>

        <createTable tableName="pharmacy_drug_dispense_settings">

            <column
                    name="pharmacy_drug_dispense_settings_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="drug_id"
                    type="int(11)">
            </column>

            <column
                    name="batch_id"
                    type="int(11)">
            </column>

            <column
                    name="pharmacy_general_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="value"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="amount"
                    type="double">

                <constraints nullable="true"/>
            </column>

            <column
                    name="inventory_id"
                    type="char(38)">
            </column>

            <column
                    name="quantity"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="form"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="front"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="back"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_drug_dispense_settings">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_drug_dispense_settings_id"
                tableName="pharmacy_drug_dispense_settings"/>

        <addForeignKeyConstraint
                baseColumnNames="drug_id"
                baseTableName="pharmacy_drug_dispense_settings"
                constraintName="pharmacy_drug_dispense_settings_drug__fk"
                referencedColumnNames="drug_id"
                referencedTableName="drug"/>

        <addForeignKeyConstraint
                baseColumnNames="inventory_id"
                baseTableName="pharmacy_drug_dispense_settings"
                constraintName="pharmacy_drug_dispense_settings_inventory__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_drug_dispense_settings"
                constraintName="pharmacy_drug_dispense_settings_location__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_drug_dispense_settings"
                constraintName="pharmacy_drug_dispense_settings_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_general_uuid"
                baseTableName="pharmacy_drug_dispense_settings"
                constraintName="pharmacy_general_uuid__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_general_variables"/>

        <update tableName="pharmacy_drug_dispense_settings">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>












    <changeSet
            id="pharmacy-2012-12-12-8:27"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_maxmin"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_maxmin table


        </comment>

        <createTable tableName="pharmacy_maxmin">

            <column
                    name="pharmacy_maxmin_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="drug_id"
                    type="int(11)">
            </column>

            <column
                    name="max"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="min"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="total"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_maxmin">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_maxmin_id"
                tableName="pharmacy_maxmin"/>

        <addForeignKeyConstraint
                baseColumnNames="drug_id"
                baseTableName="pharmacy_maxmin"
                constraintName="pharmacy_maxmin_drug_fk"
                referencedColumnNames="drug_id"
                referencedTableName="drug"/>

        <update tableName="pharmacy_maxmin">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet
            id="pharmacy-2012-12-12-8:28"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_inventory_approved"/>


            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_inventory_approved table


        </comment>

        <createTable tableName="pharmacy_inventory_approved">

            <column
                    name="pharmacy_inventory_approved_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="pharmacy_drug_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="quantity_in"
                    type="int(11)"/>

            <column
                    name="maxlevel"
                    type="int(11)"/>

            <column
                    name="minlevel"
                    type="int(11)"/>

            <column
                    name="batch_no"
                    type="int(11)">
            </column>

            <column
                    name="s11_no"
                    type="int(11)">
            </column>

            <column
                    name="expiredate"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="delivery_no"
                    type="int(11)">
            </column>

            <column
                    name="change_reason"
                    type="text"/>

            <column
                    name="pharmacy_category_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="destination_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="location_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="supplier_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="transaction_uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="incoming_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="outgoing_uuid"
                    type="char(38)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="approved"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="requestedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="issuedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="authorizedBy"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="status"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_inventory_approved">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_inventory_approved_id"
                tableName="pharmacy_inventory_approved"/>

        <addForeignKeyConstraint
                baseColumnNames="destination_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_destination__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="location_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_location__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_locations"/>

        <addForeignKeyConstraint
                baseColumnNames="supplier_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_supplier__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_supplier"/>

        <addForeignKeyConstraint
                baseColumnNames="transaction_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_transaction__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_transaction_type"/>

        <addForeignKeyConstraint
                baseColumnNames="pharmacy_category_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_category__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_category"/>

        <addForeignKeyConstraint
                baseColumnNames="incoming_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_incoming__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory_incoming"/>

        <addForeignKeyConstraint
                baseColumnNames="outgoing_uuid"
                baseTableName="pharmacy_inventory_approved"
                constraintName="pharmacy_inventory_approved_outgoing__fk"
                referencedColumnNames="uuid"
                referencedTableName="pharmacy_inventory_outgoing"/>

        <update tableName="pharmacy_inventory_approved">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>


    <changeSet
            id="pharmacy-2012-12-12-8:29"
            author="nbore">

        <preConditions onFail="MARK_RAN">

            <not>

                <tableExists tableName="pharmacy_location_users"/>
            </not>

            <dbms type="mysql"/>
        </preConditions>

        <comment>
            Creating the pharmacy_location_users table


        </comment>

        <createTable tableName="pharmacy_location_users">

            <column
                    name="pharmacy_location_users_id"
                    type="int(11)">

                <constraints
                        nullable="false"
                        primaryKey="true"/>
            </column>

            <column
                    name="usernname"
                    type="char(38)"/>

            <column
                    name="location"
                    type="char(38)"/>

            <column
                    name="creator"
                    defaultValue="0"
                    type="int(11)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="datecreated"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="voided"
                    defaultValue="0"
                    type="smallint(6)">

                <constraints nullable="false"/>
            </column>

            <column
                    name="voided_by"
                    type="int(11)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="date_voided"
                    type="datetime">

                <constraints nullable="true"/>
            </column>

            <column
                    name="void_reason"
                    type="varchar(255)">

                <constraints nullable="true"/>
            </column>

            <column
                    name="uuid"
                    type="char(38)">

                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex
                indexName="uuid"
                tableName="pharmacy_location_users">

            <column name="uuid"/>
        </createIndex>

        <addAutoIncrement
                columnDataType="int"
                columnName="pharmacy_location_users_id"
                tableName="pharmacy_location_users"/>


        <update tableName="pharmacy_location_users">

            <column
                    name="uuid"
                    valueNumeric="name-of-uuid-function"/>

            <where>
                uuid is null

            </where>
        </update>

        <modifySql dbms="mysql">

            <replace
                    replace="name-of-uuid-function"
                    with="UUID()"/>
        </modifySql>
    </changeSet>

    <changeSet author="ellymakuba" id="2013-10-25-8:36">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="drug_id" type="int(20)"/>
        </addColumn>
    </changeSet>
<changeSet author="ellymakuba" id="2013-10-25-3:09">
<addColumn tableName="pharmacy_drug_extra">
    <column name="patient_id" type="int(20)"/>
</addColumn>
</changeSet>
    <changeSet author="ellymakuba" id="2013-10-31-12:24pm">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="drug_name" type="VARCHAR(250)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2013-11-28-3:45pm">
        <addColumn tableName="pharmacy_inventory">
            <column name="last_edit_date" type="datetime"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2013-12-3-9:55am">
        <addColumn tableName="pharmacy_inventory">
            <column name="unit_price" type="VARCHAR(250)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2013-12-6-11:33am">
        <addColumn tableName="pharmacy_locations">
            <column name="batch_settings" type="int(20)"/>
            </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-01-7-09:45pm">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="pharmacy_drug_uuid" type="VARCHAR(250)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-01-9-08:59am">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="location_uuid" type="char(38)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-01-9-09:10am">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="quantity_sold" type="int(20)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-24-07:54pm">
        <addColumn tableName="pharmacy_drug_order">
            <column name="patient_uuid" type="int(11)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-25-08:26pm">
        <addColumn tableName="pharmacy_drug_order">
            <column name="expected_next_visit_date" type="datetime"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-25-10:53am">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="total_waived" type="decimal(20,2)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-25-10:52am">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="total_expected" type="decimal(20,2)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-25-10:54am">
        <addColumn tableName="pharmacy_inventory">
            <column name="buying_price" type="decimal(20,2)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-25-12:02pm">
        <addColumn tableName="pharmacy_drug_extra">
            <column name="total_amount" type="decimal(20,2)"/>
        </addColumn>
    </changeSet>
    <changeSet author="ellymakuba" id="2014-02-27-11:20am">
        <addColumn tableName="pharmacy_drug_order">
            <column name="formName" type="VARCHAR(38)"/>
        </addColumn>
    </changeSet>
</databaseChangeLog>